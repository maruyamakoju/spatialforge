<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RailScan Enterprise â€” è»Œé“ç‚¹æ¤œç®¡ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | SpatialForge</title>
  <meta name="description" content="RailScan AI ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  â€” é‰„é“äº‹æ¥­è€…å‘ã‘è»Œé“ç‚¹æ¤œç®¡ç†ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†ãƒ»åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    /* â”€â”€ CSS Variables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    :root {
      --bg: #0a0a0f;
      --surface: #12121a;
      --surface-2: #1a1a28;
      --surface-3: #1f1f30;
      --border: #1e1e2e;
      --border-2: #2a2a3e;
      --text: #e4e4ef;
      --muted: #8888a0;
      --muted-2: #5a5a72;
      --accent: #f59e0b;
      --accent-bright: #fbbf24;
      --accent-glow: rgba(245,158,11,0.15);
      --danger: #ef4444;
      --danger-bg: rgba(239,68,68,0.1);
      --danger-border: rgba(239,68,68,0.3);
      --warning: #f59e0b;
      --warning-bg: rgba(245,158,11,0.1);
      --warning-border: rgba(245,158,11,0.3);
      --safe: #22c55e;
      --safe-bg: rgba(34,197,94,0.1);
      --safe-border: rgba(34,197,94,0.3);
      --indigo: #6366f1;
      --indigo-bg: rgba(99,102,241,0.1);
      --indigo-border: rgba(99,102,241,0.3);
      --radius: 10px;
      --radius-sm: 6px;
      --radius-lg: 16px;
    }

    /* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; font-size: 14px; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Noto Sans JP', 'Yu Gothic UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
    }
    a { color: inherit; text-decoration: none; }
    button { font-family: inherit; cursor: pointer; border: none; outline: none; }
    table { border-collapse: collapse; width: 100%; }

    /* â”€â”€ Demo Watermark â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .demo-watermark {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: rgba(245,158,11,0.15);
      border: 1px solid rgba(245,158,11,0.4);
      color: var(--accent);
      font-size: 0.7rem;
      font-weight: 800;
      letter-spacing: 0.12em;
      padding: 6px 14px;
      border-radius: 20px;
      z-index: 9999;
      backdrop-filter: blur(8px);
      pointer-events: none;
    }

    /* â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    nav {
      position: fixed; top: 0; width: 100%; height: 60px;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 1.5rem;
      background: rgba(10,10,15,0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border);
      z-index: 500;
    }
    .nav-left { display: flex; align-items: center; gap: 1rem; }
    .logo {
      font-size: 1.05rem; font-weight: 700; letter-spacing: -0.02em;
      color: var(--text); display: flex; align-items: center; gap: 0.5rem;
    }
    .logo-badge {
      background: var(--accent); color: #000;
      font-size: 0.6rem; font-weight: 900; padding: 2px 7px;
      border-radius: 4px; letter-spacing: 0.06em;
    }
    .nav-divider { width: 1px; height: 24px; background: var(--border); }
    .nav-links { display: flex; align-items: center; gap: 0.1rem; }
    nav a {
      color: var(--muted); font-size: 0.82rem; padding: 0.35rem 0.7rem;
      border-radius: var(--radius-sm); transition: all 0.15s;
    }
    nav a:hover, nav a.active { color: var(--text); background: rgba(255,255,255,0.06); }
    .nav-right { display: flex; align-items: center; gap: 0.75rem; }
    .nav-alert-badge {
      display: flex; align-items: center; gap: 0.4rem;
      background: var(--danger-bg); border: 1px solid var(--danger-border);
      color: var(--danger); font-size: 0.75rem; font-weight: 700;
      padding: 4px 10px; border-radius: 20px;
    }
    .nav-alert-count { font-size: 0.85rem; font-weight: 800; }
    .nav-user {
      display: flex; align-items: center; gap: 0.5rem;
      background: var(--surface-2); border: 1px solid var(--border);
      padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; color: var(--muted);
    }
    .nav-user-dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--safe); box-shadow: 0 0 6px var(--safe);
      animation: pulse-dot 2s infinite;
    }
    @keyframes pulse-dot {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .main-content {
      margin-top: 60px;
      padding: 1.5rem;
      max-width: 1440px;
      margin-left: auto;
      margin-right: auto;
    }

    /* â”€â”€ Section Titles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .section-header {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 1rem;
    }
    .section-title {
      font-size: 0.95rem; font-weight: 700; color: var(--text);
      display: flex; align-items: center; gap: 0.5rem;
    }
    .section-title .dot {
      width: 8px; height: 8px; border-radius: 50%;
    }
    .section-action {
      font-size: 0.78rem; color: var(--indigo);
      border: 1px solid var(--indigo-border);
      padding: 4px 12px; border-radius: 20px; background: var(--indigo-bg);
      cursor: pointer; transition: all 0.15s;
    }
    .section-action:hover { background: rgba(99,102,241,0.2); }

    /* â”€â”€ KPI Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    .kpi-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      position: relative;
      overflow: hidden;
      transition: border-color 0.2s, transform 0.2s;
    }
    .kpi-card:hover { border-color: var(--border-2); transform: translateY(-1px); }
    .kpi-card::before {
      content: '';
      position: absolute; top: 0; left: 0; right: 0; height: 3px;
      border-radius: var(--radius-lg) var(--radius-lg) 0 0;
    }
    .kpi-card.indigo::before { background: var(--indigo); }
    .kpi-card.danger::before { background: var(--danger); }
    .kpi-card.safe::before { background: var(--safe); }
    .kpi-card.accent::before { background: var(--accent); }
    .kpi-label {
      font-size: 0.75rem; color: var(--muted); font-weight: 600;
      letter-spacing: 0.05em; text-transform: uppercase; margin-bottom: 0.75rem;
    }
    .kpi-value {
      font-size: 2.5rem; font-weight: 800; letter-spacing: -0.03em; line-height: 1;
      margin-bottom: 0.5rem;
    }
    .kpi-card.indigo .kpi-value { color: #818cf8; }
    .kpi-card.danger .kpi-value { color: var(--danger); }
    .kpi-card.safe .kpi-value { color: var(--safe); }
    .kpi-card.accent .kpi-value { color: var(--accent); }
    .kpi-sub { font-size: 0.78rem; color: var(--muted); }
    .kpi-sub strong { font-weight: 700; }
    .kpi-badges { display: flex; gap: 0.4rem; margin-top: 0.75rem; }
    .kpi-badge {
      font-size: 0.68rem; font-weight: 700; padding: 2px 8px;
      border-radius: 10px;
    }
    .kpi-badge.critical { background: var(--danger-bg); color: var(--danger); border: 1px solid var(--danger-border); }
    .kpi-badge.major { background: var(--warning-bg); color: var(--warning); border: 1px solid var(--warning-border); }
    .kpi-icon {
      position: absolute; right: 1.25rem; top: 1.25rem;
      font-size: 1.75rem; opacity: 0.15;
    }

    /* â”€â”€ Two-column layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .grid-2col { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; }
    .grid-3col { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; }
    .grid-7-5 { display: grid; grid-template-columns: 7fr 5fr; gap: 1rem; margin-bottom: 1.5rem; }
    .grid-5-7 { display: grid; grid-template-columns: 5fr 7fr; gap: 1rem; margin-bottom: 1.5rem; }

    /* â”€â”€ Card Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }
    .card-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 1rem 1.25rem;
      border-bottom: 1px solid var(--border);
    }
    .card-title { font-size: 0.88rem; font-weight: 700; color: var(--text); }
    .card-body { padding: 1.25rem; }

    /* â”€â”€ Track Health Map â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .track-health-table { width: 100%; }
    .track-row {
      display: grid;
      grid-template-columns: 140px 1fr 100px 70px 100px;
      align-items: center;
      gap: 0.75rem;
      padding: 0.65rem 0;
      border-bottom: 1px solid rgba(30,30,46,0.6);
    }
    .track-row:last-child { border-bottom: none; }
    .track-name { font-size: 0.82rem; font-weight: 600; color: var(--text); }
    .track-bar-wrap { position: relative; height: 14px; background: var(--surface-2); border-radius: 4px; overflow: hidden; }
    .track-bar-segments { display: flex; height: 100%; gap: 1px; }
    .track-seg {
      flex: 1; border-radius: 2px;
      transition: all 0.8s ease;
    }
    .track-seg.ok { background: var(--safe); }
    .track-seg.warn { background: var(--warning); }
    .track-seg.crit { background: var(--danger); }
    .track-seg.pending { background: var(--surface-3); }
    .track-last { font-size: 0.72rem; color: var(--muted); text-align: center; }
    .track-alerts { font-size: 0.8rem; font-weight: 700; text-align: center; }
    .status-badge {
      display: inline-flex; align-items: center; gap: 0.3rem;
      font-size: 0.68rem; font-weight: 700; padding: 3px 9px; border-radius: 10px;
      letter-spacing: 0.04em;
    }
    .badge-ok { background: var(--safe-bg); color: var(--safe); border: 1px solid var(--safe-border); }
    .badge-warn { background: var(--warning-bg); color: var(--warning); border: 1px solid var(--warning-border); }
    .badge-crit { background: var(--danger-bg); color: var(--danger); border: 1px solid var(--danger-border); }
    .badge-indigo { background: var(--indigo-bg); color: var(--indigo); border: 1px solid var(--indigo-border); }
    .badge-dot {
      width: 5px; height: 5px; border-radius: 50%;
    }
    .badge-ok .badge-dot { background: var(--safe); }
    .badge-warn .badge-dot { background: var(--warning); }
    .badge-crit .badge-dot { background: var(--danger); animation: blink-red 1s infinite; }
    @keyframes blink-red { 0%,100%{opacity:1} 50%{opacity:0.3} }

    /* â”€â”€ Inspections Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .filter-bar { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .filter-btn {
      font-size: 0.75rem; font-weight: 600; padding: 5px 14px;
      border-radius: 20px; border: 1px solid var(--border);
      background: var(--surface-2); color: var(--muted);
      transition: all 0.15s;
    }
    .filter-btn:hover { border-color: var(--border-2); color: var(--text); }
    .filter-btn.active { background: var(--indigo-bg); color: var(--indigo); border-color: var(--indigo-border); }
    .inspection-table { overflow-x: auto; margin-top: 0.75rem; }
    .inspection-table table { min-width: 900px; }
    .inspection-table th {
      text-align: left; padding: 0.65rem 0.75rem;
      font-size: 0.7rem; color: var(--muted); font-weight: 700;
      letter-spacing: 0.06em; text-transform: uppercase;
      border-bottom: 1px solid var(--border);
      white-space: nowrap;
    }
    .inspection-table td {
      padding: 0.6rem 0.75rem; font-size: 0.8rem; color: var(--text);
      border-bottom: 1px solid rgba(30,30,46,0.5);
      white-space: nowrap;
    }
    .inspection-table tr:last-child td { border-bottom: none; }
    .inspection-table tr:hover td { background: rgba(255,255,255,0.02); }
    .insp-id { font-family: 'SF Mono', 'Consolas', monospace; font-size: 0.72rem; color: var(--muted); }
    .severity-dot {
      display: inline-block; width: 8px; height: 8px; border-radius: 50%;
      margin-right: 4px;
    }
    .sev-critical { background: var(--danger); }
    .sev-major { background: var(--warning); }
    .sev-minor { background: var(--safe); }

    /* â”€â”€ Alert Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .alert-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .alert-card {
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1rem;
      transition: all 0.3s;
      position: relative;
    }
    .alert-card.processed {
      opacity: 0.45;
      border-style: dashed;
    }
    .alert-card.processed::after {
      content: 'å‡¦ç†æ¸ˆã¿';
      position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
      font-size: 0.8rem; font-weight: 800; color: var(--safe);
      background: var(--safe-bg); border: 1px solid var(--safe-border);
      padding: 4px 14px; border-radius: 20px; letter-spacing: 0.05em;
    }
    .alert-card.crit-card { border-left: 3px solid var(--danger); }
    .alert-card.major-card { border-left: 3px solid var(--warning); }
    .alert-card.minor-card { border-left: 3px solid var(--safe); }
    .alert-header { display: flex; align-items: flex-start; justify-content: space-between; gap: 0.5rem; margin-bottom: 0.6rem; }
    .alert-severity-badge {
      font-size: 0.65rem; font-weight: 800; padding: 2px 8px; border-radius: 8px;
      letter-spacing: 0.06em; white-space: nowrap;
    }
    .alert-type { font-size: 0.85rem; font-weight: 700; color: var(--text); margin-bottom: 0.25rem; }
    .alert-meta { font-size: 0.72rem; color: var(--muted); line-height: 1.8; }
    .alert-meta span { color: var(--text); font-weight: 600; }
    .alert-actions { display: flex; gap: 0.4rem; margin-top: 0.75rem; }
    .alert-btn {
      flex: 1; font-size: 0.72rem; font-weight: 700; padding: 5px 8px;
      border-radius: var(--radius-sm); border: 1px solid;
      transition: all 0.15s; text-align: center;
    }
    .alert-btn-confirm {
      background: var(--indigo-bg); color: var(--indigo); border-color: var(--indigo-border);
    }
    .alert-btn-confirm:hover { background: rgba(99,102,241,0.2); }
    .alert-btn-approve {
      background: var(--safe-bg); color: var(--safe); border-color: var(--safe-border);
    }
    .alert-btn-approve:hover { background: rgba(34,197,94,0.2); }
    .alert-btn-dismiss {
      background: var(--surface); color: var(--muted); border-color: var(--border);
    }
    .alert-btn-dismiss:hover { background: var(--surface-3); color: var(--danger); border-color: var(--danger-border); }
    .alert-assign {
      font-size: 0.68rem; color: var(--muted);
      display: flex; align-items: center; gap: 0.3rem; margin-top: 0.4rem;
    }
    .alert-assign .assign-name { color: var(--indigo); font-weight: 600; }

    /* â”€â”€ Charts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .chart-wrap { position: relative; height: 200px; }
    .chart-wrap.tall { height: 260px; }

    /* â”€â”€ System Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .sys-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem; }
    .sys-card {
      background: var(--surface-2); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 1rem;
      display: flex; flex-direction: column; gap: 0.4rem;
    }
    .sys-label { font-size: 0.7rem; color: var(--muted); font-weight: 600; letter-spacing: 0.04em; }
    .sys-value { font-size: 1.5rem; font-weight: 800; letter-spacing: -0.02em; }
    .sys-value.green { color: var(--safe); }
    .sys-value.blue { color: var(--indigo); }
    .sys-value.amber { color: var(--accent); }
    .sys-sub { font-size: 0.72rem; color: var(--muted); }
    .sys-indicator { display: flex; align-items: center; gap: 0.4rem; margin-top: 0.25rem; }
    .live-dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--safe); box-shadow: 0 0 8px var(--safe);
      animation: pulse-dot 1.5s infinite;
    }
    .live-text { font-size: 0.68rem; color: var(--safe); font-weight: 700; letter-spacing: 0.06em; }

    /* â”€â”€ Maintenance Calendar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .cal-grid {
      display: grid; grid-template-columns: repeat(7, 1fr); gap: 3px;
      margin-bottom: 0.75rem;
    }
    .cal-header-cell {
      text-align: center; font-size: 0.65rem; font-weight: 700;
      color: var(--muted); padding: 4px 0; letter-spacing: 0.04em;
    }
    .cal-cell {
      background: var(--surface-2); border: 1px solid var(--border);
      border-radius: 4px; min-height: 68px; padding: 4px;
      position: relative;
    }
    .cal-cell.today { border-color: var(--accent); }
    .cal-cell.outside { opacity: 0.35; }
    .cal-day {
      font-size: 0.68rem; font-weight: 700; color: var(--muted);
      margin-bottom: 2px;
    }
    .cal-cell.today .cal-day { color: var(--accent); }
    .cal-event {
      font-size: 0.6rem; font-weight: 600; padding: 1px 4px;
      border-radius: 3px; margin-bottom: 2px; line-height: 1.4;
      overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
    }
    .cal-event.routine { background: rgba(99,102,241,0.2); color: #a5b4fc; }
    .cal-event.emergency { background: var(--danger-bg); color: #fca5a5; }
    .cal-event.preventive { background: var(--safe-bg); color: #86efac; }
    .schedule-list { list-style: none; }
    .schedule-item {
      display: flex; align-items: flex-start; gap: 0.75rem;
      padding: 0.65rem 0; border-bottom: 1px solid rgba(30,30,46,0.6);
    }
    .schedule-item:last-child { border-bottom: none; }
    .schedule-type-dot {
      width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; margin-top: 4px;
    }
    .sched-routine { background: var(--indigo); }
    .sched-emergency { background: var(--danger); }
    .sched-preventive { background: var(--safe); }
    .schedule-info { flex: 1; }
    .schedule-name { font-size: 0.8rem; font-weight: 600; color: var(--text); margin-bottom: 0.1rem; }
    .schedule-detail { font-size: 0.7rem; color: var(--muted); }

    /* â”€â”€ Scrollbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--border-2); border-radius: 3px; }

    /* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    footer {
      background: var(--surface); border-top: 1px solid var(--border);
      padding: 1.25rem 1.5rem;
      display: flex; align-items: center; justify-content: space-between;
      font-size: 0.75rem; color: var(--muted);
      margin-top: 1.5rem;
    }
    .footer-left { display: flex; align-items: center; gap: 1rem; }
    .footer-links { display: flex; gap: 1rem; }
    .footer-links a { color: var(--muted); transition: color 0.15s; }
    .footer-links a:hover { color: var(--text); }
    .footer-brand { font-weight: 700; color: var(--text); }
    .footer-version {
      font-size: 0.68rem; background: var(--surface-2);
      border: 1px solid var(--border); color: var(--muted);
      padding: 2px 8px; border-radius: 10px;
    }

    /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 1200px) {
      .kpi-grid { grid-template-columns: repeat(2, 1fr); }
      .grid-2col, .grid-7-5, .grid-5-7 { grid-template-columns: 1fr; }
      .grid-3col { grid-template-columns: 1fr 1fr; }
      .alert-grid { grid-template-columns: 1fr; }
      .sys-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      .kpi-grid { grid-template-columns: 1fr; }
      .grid-3col { grid-template-columns: 1fr; }
      nav { padding: 0 1rem; }
      .nav-links { display: none; }
      .main-content { padding: 1rem; }
      .sys-grid { grid-template-columns: 1fr 1fr; }
    }

    /* â”€â”€ Utilities â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .mb-1 { margin-bottom: 1rem; }
    .mb-15 { margin-bottom: 1.5rem; }
    .text-muted { color: var(--muted); }
    .text-danger { color: var(--danger); }
    .text-safe { color: var(--safe); }
    .text-indigo { color: var(--indigo); }
    .text-accent { color: var(--accent); }
    .fw-700 { font-weight: 700; }
    .font-mono { font-family: 'SF Mono', 'Consolas', monospace; }

    /* â”€â”€ Loading shimmer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @keyframes shimmer {
      0% { background-position: -400px 0; }
      100% { background-position: 400px 0; }
    }
    .spinner {
      display: inline-block; width: 10px; height: 10px;
      border: 2px solid var(--indigo-border);
      border-top-color: var(--indigo);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-right: 4px;
      vertical-align: middle;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>

<!-- Demo watermark -->
<div class="demo-watermark">DEMO ENVIRONMENT</div>

<!-- â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<nav>
  <div class="nav-left">
    <a href="index.html" class="logo">
      Spatial<span style="color:var(--accent)">Forge</span>
      <span class="logo-badge">RAIL</span>
    </a>
    <div class="nav-divider"></div>
    <div class="nav-links">
      <a href="#kpi" class="active">ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </a>
      <a href="#alerts">ã‚¢ãƒ©ãƒ¼ãƒˆ</a>
      <a href="#analytics">ãƒ¬ãƒãƒ¼ãƒˆ</a>
      <a href="#maintenance">ä¿å®ˆè¨ˆç”»</a>
      <a href="#system">è¨­å®š</a>
      <a href="whitepaper.html" style="color:var(--safe)">æŠ€è¡“ç™½æ›¸</a>
      <a href="rail-demo.html" style="color:var(--accent)">â† ãƒ‡ãƒ¢ã¸æˆ»ã‚‹</a>
    </div>
  </div>
  <div class="nav-right">
    <div class="nav-alert-badge">
      <span style="font-size:0.75rem">âš </span>
      <span>æœªè§£æ±ºã‚¢ãƒ©ãƒ¼ãƒˆ</span>
      <span class="nav-alert-count" id="navAlertCount">23</span>
    </div>
    <div class="nav-user">
      <div class="nav-user-dot"></div>
      ç®¡ç†è€…ï¼šç”°ä¸­ å¤ªéƒ
    </div>
  </div>
</nav>

<!-- â”€â”€ Main Content â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="main-content">

  <!-- â”€â”€ Section 1: KPI Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="kpi" style="margin-bottom:1.5rem">
    <div class="section-header">
      <div class="section-title">
        <div class="dot" style="background:var(--indigo)"></div>
        ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
        <span style="font-size:0.7rem;color:var(--muted);font-weight:400;margin-left:0.25rem">â€” 2026å¹´2æœˆ21æ—¥ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ </span>
      </div>
      <div style="display:flex;gap:0.5rem;align-items:center">
        <div class="live-dot"></div>
        <span style="font-size:0.72rem;color:var(--safe);font-weight:700">LIVE</span>
        <span style="font-size:0.72rem;color:var(--muted);margin-left:0.5rem" id="lastUpdate">æœ€çµ‚æ›´æ–°: 08:47:32</span>
      </div>
    </div>

    <div class="kpi-grid">
      <div class="kpi-card indigo">
        <div class="kpi-icon">ğŸ›¤</div>
        <div class="kpi-label">ç›£è¦–è·¯ç·š</div>
        <div class="kpi-value">8è·¯ç·š</div>
        <div class="kpi-sub"><strong style="color:#818cf8">2,847 km</strong> ç·ç›£è¦–è·é›¢</div>
        <div class="kpi-badges">
          <span class="kpi-badge" style="background:var(--indigo-bg);color:var(--indigo);border:1px solid var(--indigo-border)">å¹¹ç·š 3è·¯ç·š</span>
          <span class="kpi-badge" style="background:var(--surface-3);color:var(--muted);border:1px solid var(--border)">æ”¯ç·š 5è·¯ç·š</span>
        </div>
      </div>

      <div class="kpi-card danger">
        <div class="kpi-icon">âš </div>
        <div class="kpi-label">æœªè§£æ±ºã‚¢ãƒ©ãƒ¼ãƒˆ</div>
        <div class="kpi-value" id="kpiAlertCount">23ä»¶</div>
        <div class="kpi-sub">è¦å¯¾å¿œã®ã‚¢ãƒ©ãƒ¼ãƒˆç·æ•°</div>
        <div class="kpi-badges">
          <span class="kpi-badge critical">ç·Šæ€¥ 7ä»¶</span>
          <span class="kpi-badge major">é‡è¦ 16ä»¶</span>
        </div>
      </div>

      <div class="kpi-card safe">
        <div class="kpi-icon">âœ“</div>
        <div class="kpi-label">æœ¬æ—¥ã®ç‚¹æ¤œ</div>
        <div class="kpi-value" id="kpiInspCount">47ä»¶</div>
        <div class="kpi-sub">é‹è¡Œå®Œäº† / ä»Šæ—¥</div>
        <div class="kpi-badges">
          <span class="kpi-badge" style="background:var(--safe-bg);color:var(--safe);border:1px solid var(--safe-border)">æ­£å¸¸ 39ä»¶</span>
          <span class="kpi-badge major">è¦ç¢ºèª 8ä»¶</span>
        </div>
      </div>

      <div class="kpi-card accent">
        <div class="kpi-icon">â—</div>
        <div class="kpi-label">ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç‡</div>
        <div class="kpi-value">99.7%</div>
        <div class="kpi-sub">éå»30æ—¥é–“ã®ç¨¼åƒå®Ÿç¸¾</div>
        <div class="kpi-badges">
          <span class="kpi-badge" style="background:var(--safe-bg);color:var(--safe);border:1px solid var(--safe-border)">SLA é”æˆ</span>
          <span class="kpi-badge" style="background:var(--surface-3);color:var(--muted);border:1px solid var(--border)">åœæ­¢ 2.2æ™‚é–“</span>
        </div>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Section 2: Track Health Map â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="trackhealth" class="mb-15">
    <div class="card">
      <div class="card-header">
        <div class="section-title">
          <div class="dot" style="background:var(--safe)"></div>
          è·¯ç·šå¥å…¨åº¦ãƒãƒƒãƒ—
        </div>
        <div style="display:flex;gap:0.75rem;align-items:center;font-size:0.72rem;color:var(--muted)">
          <span style="display:inline-flex;align-items:center;gap:4px"><span style="display:inline-block;width:10px;height:10px;background:var(--safe);border-radius:2px"></span>æ­£å¸¸</span>
          <span style="display:inline-flex;align-items:center;gap:4px"><span style="display:inline-block;width:10px;height:10px;background:var(--warning);border-radius:2px"></span>æ³¨æ„</span>
          <span style="display:inline-flex;align-items:center;gap:4px"><span style="display:inline-block;width:10px;height:10px;background:var(--danger);border-radius:2px"></span>ç·Šæ€¥</span>
          <span style="display:inline-flex;align-items:center;gap:4px"><span style="display:inline-block;width:10px;height:10px;background:var(--surface-3);border-radius:2px"></span>æœªç‚¹æ¤œ</span>
        </div>
      </div>
      <div class="card-body">
        <div style="display:grid;grid-template-columns:140px 1fr 100px 70px 100px;gap:0.75rem;padding:0 0 0.5rem;margin-bottom:0.5rem;border-bottom:1px solid var(--border)">
          <span style="font-size:0.68rem;font-weight:700;color:var(--muted);letter-spacing:0.06em;text-transform:uppercase">è·¯ç·šå</span>
          <span style="font-size:0.68rem;font-weight:700;color:var(--muted);letter-spacing:0.06em;text-transform:uppercase">å¥å…¨åº¦ãƒãƒ¼ï¼ˆåŒºé–“åˆ¥ï¼‰</span>
          <span style="font-size:0.68rem;font-weight:700;color:var(--muted);letter-spacing:0.06em;text-transform:uppercase;text-align:center">æœ€çµ‚ç‚¹æ¤œ</span>
          <span style="font-size:0.68rem;font-weight:700;color:var(--muted);letter-spacing:0.06em;text-transform:uppercase;text-align:center">ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
          <span style="font-size:0.68rem;font-weight:700;color:var(--muted);letter-spacing:0.06em;text-transform:uppercase;text-align:center">çŠ¶æ…‹</span>
        </div>
        <div id="trackHealthRows"></div>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Section 3: Inspections Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="inspections" class="mb-15">
    <div class="card">
      <div class="card-header">
        <div class="section-title">
          <div class="dot" style="background:var(--indigo)"></div>
          ç‚¹æ¤œå®Ÿæ–½å±¥æ­´
        </div>
        <div class="filter-bar" id="tableFilters">
          <button class="filter-btn active" data-filter="all">ã™ã¹ã¦</button>
          <button class="filter-btn" data-filter="å®Œäº†">å®Œäº†</button>
          <button class="filter-btn" data-filter="å‡¦ç†ä¸­">å‡¦ç†ä¸­</button>
          <button class="filter-btn" data-filter="ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡">ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡</button>
          <button class="filter-btn" data-sev="critical">ç·Šæ€¥</button>
          <button class="filter-btn" data-sev="major">é‡è¦</button>
          <button class="filter-btn" data-sev="minor">è»½å¾®</button>
        </div>
      </div>
      <div class="inspection-table">
        <table id="inspTable">
          <thead>
            <tr>
              <th>ç‚¹æ¤œID</th>
              <th>è·¯ç·š</th>
              <th>æ—¥æ™‚</th>
              <th>åŒºé–“</th>
              <th>ãƒ•ãƒ¬ãƒ¼ãƒ æ•°</th>
              <th>æ¤œå‡ºæ•°</th>
              <th>é‡ç—‡åº¦</th>
              <th>å‡¦ç†æ™‚é–“</th>
              <th>çŠ¶æ…‹</th>
            </tr>
          </thead>
          <tbody id="inspTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Section 4: Alert Management â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="alerts" class="mb-15">
    <div class="section-header">
      <div class="section-title">
        <div class="dot" style="background:var(--danger)"></div>
        ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†ã‚­ãƒ¥ãƒ¼
        <span class="status-badge badge-crit" style="margin-left:0.5rem" id="alertCountBadge">
          <span class="badge-dot"></span> ç·Šæ€¥ 7ä»¶
        </span>
      </div>
      <div style="font-size:0.78rem;color:var(--muted)">ã‚¯ãƒªãƒƒã‚¯ã§å‡¦ç† â€” å‡¦ç†æ¸ˆã¿ã‚¢ãƒ©ãƒ¼ãƒˆã¯è‡ªå‹•çš„ã«é™¤å¤–ã•ã‚Œã¾ã™</div>
    </div>
    <div class="alert-grid" id="alertGrid"></div>
  </div>

  <!-- â”€â”€ Section 5: Analytics Charts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="analytics" class="mb-15">
    <div class="section-header">
      <div class="section-title">
        <div class="dot" style="background:var(--accent)"></div>
        åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆ
      </div>
      <span class="section-action">å…¨ãƒ¬ãƒãƒ¼ãƒˆã‚’è¦‹ã‚‹ â†’</span>
    </div>
    <div class="grid-3col">
      <div class="card">
        <div class="card-header">
          <div class="card-title">é€±æ¬¡æ¬ é™¥æ¤œå‡ºãƒˆãƒ¬ãƒ³ãƒ‰</div>
          <span style="font-size:0.72rem;color:var(--muted)">éå»8é€±</span>
        </div>
        <div class="card-body">
          <div class="chart-wrap tall"><canvas id="chartTrend"></canvas></div>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div class="card-title">æ¬ é™¥ç¨®åˆ¥åˆ†å¸ƒ</div>
          <span style="font-size:0.72rem;color:var(--muted)">å…¨è·¯ç·šåˆè¨ˆ</span>
        </div>
        <div class="card-body">
          <div class="chart-wrap tall"><canvas id="chartDoughnut"></canvas></div>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div class="card-title">è·¯ç·šåˆ¥ãƒªã‚¹ã‚¯ã‚¹ã‚³ã‚¢</div>
          <span style="font-size:0.72rem;color:var(--muted)">ç¾æ™‚ç‚¹</span>
        </div>
        <div class="card-body">
          <div class="chart-wrap tall"><canvas id="chartRisk"></canvas></div>
        </div>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Section 6: Maintenance Schedule â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="maintenance" class="mb-15">
    <div class="section-header">
      <div class="section-title">
        <div class="dot" style="background:var(--indigo)"></div>
        ä¿å®ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        <span style="font-size:0.78rem;color:var(--muted);font-weight:400">â€” 2026å¹´2æœˆã€œ3æœˆ</span>
      </div>
      <span class="section-action">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç·¨é›†</span>
    </div>
    <div class="grid-7-5">
      <div class="card">
        <div class="card-header">
          <div class="card-title">æœˆé–“ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ“ãƒ¥ãƒ¼</div>
          <div style="display:flex;gap:0.75rem;font-size:0.7rem;color:var(--muted)">
            <span style="display:inline-flex;align-items:center;gap:4px"><span style="display:inline-block;width:8px;height:8px;background:var(--indigo);border-radius:50%"></span>é€šå¸¸ç‚¹æ¤œ</span>
            <span style="display:inline-flex;align-items:center;gap:4px"><span style="display:inline-block;width:8px;height:8px;background:var(--danger);border-radius:50%"></span>ç·Šæ€¥å¯¾å¿œ</span>
            <span style="display:inline-flex;align-items:center;gap:4px"><span style="display:inline-block;width:8px;height:8px;background:var(--safe);border-radius:50%"></span>äºˆé˜²ä¿å…¨</span>
          </div>
        </div>
        <div class="card-body">
          <div class="cal-grid" id="calGrid"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div class="card-title">ç›´è¿‘ã®äºˆå®šä½œæ¥­</div>
          <span style="font-size:0.72rem;color:var(--muted)">5ä»¶</span>
        </div>
        <div class="card-body">
          <ul class="schedule-list" id="scheduleList"></ul>
        </div>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Section 7: System Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="system" class="mb-15">
    <div class="section-header">
      <div class="section-title">
        <div class="dot" style="background:var(--safe)"></div>
        ã‚·ã‚¹ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
      </div>
      <div class="sys-indicator">
        <div class="live-dot"></div>
        <span class="live-text">OPERATIONAL</span>
      </div>
    </div>
    <div class="sys-grid">
      <div class="sys-card">
        <div class="sys-label">GPU ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ç¨¼åƒ</div>
        <div class="sys-value green">4 / 4</div>
        <div class="sys-sub">GPU</div>
        <div class="sys-indicator" style="margin-top:0.25rem">
          <div class="live-dot"></div>
          <span class="live-text">ALL ONLINE</span>
        </div>
      </div>
      <div class="sys-card">
        <div class="sys-label">å‡¦ç†ã‚­ãƒ¥ãƒ¼</div>
        <div class="sys-value green">0ä»¶</div>
        <div class="sys-sub">å¾…æ©Ÿã‚¸ãƒ§ãƒ–</div>
        <div class="sys-indicator" style="margin-top:0.25rem">
          <div class="live-dot"></div>
          <span class="live-text">QUEUE CLEAR</span>
        </div>
      </div>
      <div class="sys-card">
        <div class="sys-label">æœ¬æ—¥ã®å‡¦ç†ãƒ•ãƒ¬ãƒ¼ãƒ æ•°</div>
        <div class="sys-value blue" id="frameCounter">287,432</div>
        <div class="sys-sub">ãƒ•ãƒ¬ãƒ¼ãƒ  / ä»Šæ—¥</div>
        <div class="sys-indicator" style="margin-top:0.25rem">
          <div class="live-dot"></div>
          <span class="live-text">ACCUMULATING</span>
        </div>
      </div>
      <div class="sys-card">
        <div class="sys-label">API ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·</div>
        <div class="sys-value amber">13 ms</div>
        <div class="sys-sub">å¹³å‡å¿œç­”æ™‚é–“</div>
        <div class="sys-indicator" style="margin-top:0.25rem">
          <div class="live-dot"></div>
          <span class="live-text">NOMINAL</span>
        </div>
      </div>
    </div>
  </div>

</div><!-- /main-content -->

<!-- â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<footer>
  <div class="footer-left">
    <span class="footer-brand">SpatialForge</span>
    <span class="footer-version">RailScan Enterprise v2.0</span>
  </div>
  <div class="footer-links">
    <a href="#">ã‚µãƒãƒ¼ãƒˆ</a>
    <a href="#">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
    <a href="#">åˆ©ç”¨è¦ç´„</a>
    <a href="proposal.html">ææ¡ˆæ›¸</a>
    <a href="rail-demo.html">AIãƒ‡ãƒ¢</a>
    <a href="index.html">ãƒˆãƒƒãƒ—</a>
  </div>
  <div style="font-size:0.72rem;color:var(--muted-2)">
    Â© 2026 SpatialForge, Inc. â€” ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç‚¹æ¤œãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
  </div>
</footer>

<!-- â”€â”€ JavaScript â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<script>
'use strict';

/* â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function rnd(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
function fmt(n) { return n.toLocaleString('ja-JP'); }

const LINES = ['æ±æµ·é“æœ¬ç·š','å±±æ‰‹ç·š','ä¸­å¤®æœ¬ç·š','äº¬æµœæ±åŒ—ç·š','æ¨ªé ˆè³€ç·š','ç·æ­¦æœ¬ç·š','å¸¸ç£ç·š','æ±åŒ—æœ¬ç·š'];
const ENGINEERS = ['ç”°ä¸­ å¤ªéƒ','éˆ´æœ¨ ä¸€éƒ','ä½è—¤ å¥','ä¼Šè—¤ èª ','æ¸¡è¾º é›…å¿—','ä¸­æ‘ æµ©äºŒ','å°æ— è£•','åŠ è—¤ æ­£ä¸€'];

/* â”€â”€ Track Health Map â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function buildTrackHealth() {
  const lineData = [
    { name:'æ±æµ·é“æœ¬ç·š', km:589, segs:30, crits:1, warns:3, lastInsp:'06:32',   alerts:4 },
    { name:'å±±æ‰‹ç·š',     km:34,  segs:20, crits:0, warns:1, lastInsp:'07:15',   alerts:1 },
    { name:'ä¸­å¤®æœ¬ç·š',   km:424, segs:25, crits:2, warns:4, lastInsp:'05:48',   alerts:7 },
    { name:'äº¬æµœæ±åŒ—ç·š', km:79,  segs:20, crits:0, warns:2, lastInsp:'07:02',   alerts:2 },
    { name:'æ¨ªé ˆè³€ç·š',   km:64,  segs:18, crits:0, warns:1, lastInsp:'06:55',   alerts:1 },
    { name:'ç·æ­¦æœ¬ç·š',   km:164, segs:22, crits:1, warns:3, lastInsp:'05:20',   alerts:4 },
    { name:'å¸¸ç£ç·š',     km:343, segs:24, crits:2, warns:5, lastInsp:'04:40',   alerts:3 },
    { name:'æ±åŒ—æœ¬ç·š',   km:1150,segs:28, crits:1, warns:2, lastInsp:'03:15',   alerts:1 },
  ];

  const container = document.getElementById('trackHealthRows');
  lineData.forEach(line => {
    // Build segment data
    const segments = [];
    let remaining = line.segs;
    const critSegs = line.crits;
    const warnSegs = line.warns;
    const pendingSegs = Math.max(0, Math.floor(remaining * 0.05));
    const okSegs = remaining - critSegs - warnSegs - pendingSegs;
    for(let i=0; i<okSegs; i++) segments.push('ok');
    for(let i=0; i<warnSegs; i++) segments.push('warn');
    for(let i=0; i<critSegs; i++) segments.push('crit');
    for(let i=0; i<pendingSegs; i++) segments.push('pending');
    // Shuffle
    for(let i=segments.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [segments[i],segments[j]]=[segments[j],segments[i]];
    }

    const statusClass = line.crits > 0 ? 'badge-crit' : line.warns > 0 ? 'badge-warn' : 'badge-ok';
    const statusText  = line.crits > 0 ? 'ç·Šæ€¥å¯¾å¿œä¸­' : line.warns > 0 ? 'è¦æ³¨æ„' : 'æ­£å¸¸';
    const alertColor  = line.alerts > 3 ? 'var(--danger)' : line.alerts > 0 ? 'var(--warning)' : 'var(--safe)';

    const row = document.createElement('div');
    row.className = 'track-row';
    row.innerHTML = `
      <div>
        <div class="track-name">${line.name}</div>
        <div style="font-size:0.65rem;color:var(--muted)">${line.km.toLocaleString()} km</div>
      </div>
      <div class="track-bar-wrap">
        <div class="track-bar-segments">
          ${segments.map(s=>`<div class="track-seg ${s}" style="opacity:0;transition:opacity 0.6s"></div>`).join('')}
        </div>
      </div>
      <div class="track-last">æœ¬æ—¥ ${line.lastInsp}</div>
      <div class="track-alerts" style="color:${alertColor}">${line.alerts}ä»¶</div>
      <div style="text-align:center">
        <span class="status-badge ${statusClass}">
          <span class="badge-dot"></span> ${statusText}
        </span>
      </div>`;
    container.appendChild(row);
  });

  // Animate bars in
  setTimeout(() => {
    document.querySelectorAll('.track-seg').forEach((seg, i) => {
      setTimeout(() => { seg.style.opacity = '1'; }, i * 8);
    });
  }, 200);
})();

/* â”€â”€ Inspections Table Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const inspections = [
  { id:'RS-2026-0221-001', line:'æ±æµ·é“æœ¬ç·š', time:'2026-02-21 06:32', section:'æ±äº¬â†’å“å· 6.8km', frames:'4,082', detections:8,  sev:'major',    proc:'54.7s', status:'å®Œäº†' },
  { id:'RS-2026-0221-002', line:'å±±æ‰‹ç·š',     time:'2026-02-21 07:15', section:'æ¸‹è°·â†’æ–°å®¿ 3.1km', frames:'1,862', detections:1,  sev:'minor',    proc:'24.1s', status:'å®Œäº†' },
  { id:'RS-2026-0221-003', line:'ä¸­å¤®æœ¬ç·š',   time:'2026-02-21 05:48', section:'æ–°å®¿â†’é«˜å°¾ 45.2km',frames:'27,192',detections:14, sev:'critical', proc:'362.4s',status:'ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡' },
  { id:'RS-2026-0221-004', line:'äº¬æµœæ±åŒ—ç·š', time:'2026-02-21 07:02', section:'å¤§å®®â†’å·å£ 14.7km', frames:'8,842', detections:3,  sev:'minor',    proc:'117.3s',status:'å®Œäº†' },
  { id:'RS-2026-0221-005', line:'æ¨ªé ˆè³€ç·š',   time:'2026-02-21 06:55', section:'æ¨ªæµœâ†’å¤§èˆ¹ 11.8km', frames:'7,092', detections:2,  sev:'major',    proc:'94.2s', status:'å®Œäº†' },
  { id:'RS-2026-0221-006', line:'ç·æ­¦æœ¬ç·š',   time:'2026-02-21 05:20', section:'éŒ¦ç³¸ç”ºâ†’åƒè‘‰ 39.4km',frames:'23,641',detections:11, sev:'critical', proc:'314.7s',status:'ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡' },
  { id:'RS-2026-0221-007', line:'å¸¸ç£ç·š',     time:'2026-02-21 04:40', section:'ä¸Šé‡â†’å–æ‰‹ 40.8km', frames:'24,492', detections:9,  sev:'major',    proc:'326.1s',status:'å‡¦ç†ä¸­' },
  { id:'RS-2026-0221-008', line:'æ±åŒ—æœ¬ç·š',   time:'2026-02-21 03:15', section:'å¤§å®®â†’å¤æ²³ 57.2km', frames:'34,372', detections:5,  sev:'minor',    proc:'457.8s',status:'å®Œäº†' },
  { id:'RS-2026-0221-009', line:'æ±æµ·é“æœ¬ç·š', time:'2026-02-20 22:47', section:'å“å·â†’å·å´ 8.4km',  frames:'5,042', detections:6,  sev:'major',    proc:'67.2s', status:'å®Œäº†' },
  { id:'RS-2026-0221-010', line:'ä¸­å¤®æœ¬ç·š',   time:'2026-02-20 21:30', section:'é«˜å°¾â†’å…«ç‹å­ 5.4km',frames:'3,242', detections:12, sev:'critical', proc:'43.1s', status:'å®Œäº†' },
  { id:'RS-2026-0221-011', line:'å±±æ‰‹ç·š',     time:'2026-02-20 21:15', section:'æ–°å®¿â†’æ± è¢‹ 3.6km',  frames:'2,162', detections:0,  sev:'minor',    proc:'28.8s', status:'å®Œäº†' },
  { id:'RS-2026-0221-012', line:'äº¬æµœæ±åŒ—ç·š', time:'2026-02-20 20:58', section:'å·å£â†’æµ¦å’Œ 3.4km',  frames:'2,042', detections:2,  sev:'minor',    proc:'27.2s', status:'å®Œäº†' },
  { id:'RS-2026-0221-013', line:'å¸¸ç£ç·š',     time:'2026-02-20 19:22', section:'å–æ‰‹â†’è—¤ä»£ 4.1km',  frames:'2,462', detections:7,  sev:'major',    proc:'32.8s', status:'å‡¦ç†ä¸­' },
  { id:'RS-2026-0221-014', line:'ç·æ­¦æœ¬ç·š',   time:'2026-02-20 18:44', section:'åƒè‘‰â†’è˜‡æˆ‘ 4.6km',  frames:'2,762', detections:3,  sev:'minor',    proc:'36.8s', status:'å®Œäº†' },
  { id:'RS-2026-0221-015', line:'æ±åŒ—æœ¬ç·š',   time:'2026-02-20 17:05', section:'å¤æ²³â†’å°å±± 17.3km', frames:'10,382',detections:4,  sev:'major',    proc:'138.4s',status:'å®Œäº†' },
];

function buildStatusBadge(status) {
  if (status === 'å®Œäº†') return `<span class="status-badge badge-ok"><span class="badge-dot"></span>${status}</span>`;
  if (status === 'å‡¦ç†ä¸­') return `<span class="status-badge badge-indigo"><span class="spinner"></span>${status}</span>`;
  return `<span class="status-badge badge-warn"><span class="badge-dot"></span>${status}</span>`;
}

function buildSevCell(sev) {
  const cls = sev === 'critical' ? 'sev-critical' : sev === 'major' ? 'sev-major' : 'sev-minor';
  const label = sev === 'critical' ? 'ç·Šæ€¥' : sev === 'major' ? 'é‡è¦' : 'è»½å¾®';
  return `<span class="severity-dot ${cls}"></span>${label}`;
}

function renderTable(filterStatus, filterSev) {
  const tbody = document.getElementById('inspTableBody');
  tbody.innerHTML = '';
  inspections.forEach(row => {
    if (filterStatus && filterStatus !== 'all' && row.status !== filterStatus) return;
    if (filterSev && row.sev !== filterSev) return;
    const tr = document.createElement('tr');
    tr.dataset.status = row.status;
    tr.dataset.sev = row.sev;
    tr.innerHTML = `
      <td class="insp-id">${row.id}</td>
      <td class="fw-700">${row.line}</td>
      <td class="text-muted font-mono" style="font-size:0.72rem">${row.time}</td>
      <td>${row.section}</td>
      <td class="text-muted" style="text-align:right">${row.frames}</td>
      <td style="text-align:center;font-weight:700;color:${row.detections>8?'var(--danger)':row.detections>3?'var(--warning)':'var(--text)'}">${row.detections}ä»¶</td>
      <td>${buildSevCell(row.sev)}</td>
      <td class="text-muted font-mono" style="font-size:0.72rem;text-align:right">${row.proc}</td>
      <td>${buildStatusBadge(row.status)}</td>`;
    tbody.appendChild(tr);
  });
}

renderTable('all', null);

// Filter button logic
let activeFilter = 'all';
let activeSev = null;
document.getElementById('tableFilters').addEventListener('click', e => {
  const btn = e.target.closest('.filter-btn');
  if (!btn) return;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  if (btn.dataset.filter !== undefined) { activeFilter = btn.dataset.filter; activeSev = null; }
  else if (btn.dataset.sev !== undefined) { activeSev = btn.dataset.sev; activeFilter = null; }
  renderTable(activeFilter, activeSev);
});

/* â”€â”€ Alert Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const alertData = [
  { id:1, sev:'critical', sevJa:'ç·Šæ€¥', type:'ãƒ¬ãƒ¼ãƒ«ãè£‚',      line:'ä¸­å¤®æœ¬ç·š',   km:'K+204.7', time:'06:48', station:'é«˜å°¾é§… 3.2km', assigned:'ç”°ä¸­ å¤ªéƒ', cardClass:'crit-card' },
  { id:2, sev:'critical', sevJa:'ç·Šæ€¥', type:'ãƒ¬ãƒ¼ãƒ«ãè£‚',      line:'ç·æ­¦æœ¬ç·š',   km:'K+89.3',  time:'05:22', station:'åƒè‘‰é§… 1.8km', assigned:'',          cardClass:'crit-card' },
  { id:3, sev:'critical', sevJa:'ç·Šæ€¥', type:'ç· çµè£…ç½®æ¬ æ',     line:'å¸¸ç£ç·š',     km:'K+158.4', time:'04:55', station:'å–æ‰‹é§… 4.1km', assigned:'éˆ´æœ¨ ä¸€éƒ', cardClass:'crit-card' },
  { id:4, sev:'critical', sevJa:'ç·Šæ€¥', type:'ãƒ¬ãƒ¼ãƒ«ãè£‚',      line:'æ±æµ·é“æœ¬ç·š', km:'K+45.2',  time:'03:30', station:'å·å´é§… 2.7km', assigned:'',          cardClass:'crit-card' },
  { id:5, sev:'major',    sevJa:'é‡è¦', type:'ãƒ¬ãƒ¼ãƒ«å‰¥é›¢',       line:'ä¸­å¤®æœ¬ç·š',   km:'K+312.6', time:'05:48', station:'å…«ç‹å­é§… 5.3km',assigned:'ä½è—¤ å¥',   cardClass:'major-card' },
  { id:6, sev:'major',    sevJa:'é‡è¦', type:'ãƒ¬ãƒ¼ãƒ«æ‘©è€—',       line:'æ±æµ·é“æœ¬ç·š', km:'K+72.9',  time:'06:32', station:'å“å·é§… 0.8km', assigned:'ä¼Šè—¤ èª ',   cardClass:'major-card' },
  { id:7, sev:'major',    sevJa:'é‡è¦', type:'ã¾ãã‚‰ãæå‚·',     line:'ç·æ­¦æœ¬ç·š',   km:'K+124.1', time:'05:20', station:'æ´¥ç”°æ²¼é§… 2.1km',assigned:'',          cardClass:'major-card' },
  { id:8, sev:'major',    sevJa:'é‡è¦', type:'ãƒ¬ãƒ¼ãƒ«å‰¥é›¢',       line:'å¸¸ç£ç·š',     km:'K+201.8', time:'04:40', station:'æ¾æˆ¸é§… 1.5km', assigned:'æ¸¡è¾º é›…å¿—', cardClass:'major-card' },
  { id:9, sev:'minor',    sevJa:'è»½å¾®', type:'ãƒ¬ãƒ¼ãƒ«æ³¢çŠ¶æ‘©è€—',   line:'å±±æ‰‹ç·š',     km:'K+18.3',  time:'07:15', station:'æ¸‹è°·é§… 1.2km', assigned:'',          cardClass:'minor-card' },
  { id:10,sev:'minor',    sevJa:'è»½å¾®', type:'ãƒ¬ãƒ¼ãƒ«æ³¢çŠ¶æ‘©è€—',   line:'äº¬æµœæ±åŒ—ç·š', km:'K+52.7',  time:'07:02', station:'æµ¦å’Œé§… 3.4km', assigned:'ä¸­æ‘ æµ©äºŒ', cardClass:'minor-card' },
];

let alertCount = 23;
let critCount = 7;

function buildAlertGrid() {
  const grid = document.getElementById('alertGrid');
  grid.innerHTML = '';
  alertData.forEach(alert => {
    const sevBgColor = alert.sev==='critical'?'var(--danger-bg)':alert.sev==='major'?'var(--warning-bg)':'var(--safe-bg)';
    const sevColor   = alert.sev==='critical'?'var(--danger)':alert.sev==='major'?'var(--warning)':'var(--safe)';
    const sevBorder  = alert.sev==='critical'?'var(--danger-border)':alert.sev==='major'?'var(--warning-border)':'var(--safe-border)';
    const assignHtml = alert.assigned
      ? `<div class="alert-assign">æ‹…å½“: <span class="assign-name">${alert.assigned}</span></div>`
      : `<div class="alert-assign" style="color:var(--muted-2)">æœªå‰²å½“ â€” ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ‹…å½“è€…ã‚’è¨­å®š</div>`;
    const card = document.createElement('div');
    card.className = `alert-card ${alert.cardClass}`;
    card.id = `alert-card-${alert.id}`;
    card.innerHTML = `
      <div class="alert-header">
        <div>
          <div class="alert-type">${alert.type}</div>
          <span style="font-size:0.68rem;color:var(--muted)">${alert.km} â€” ${alert.line}</span>
        </div>
        <span class="alert-severity-badge" style="background:${sevBgColor};color:${sevColor};border:1px solid ${sevBorder}">${alert.sevJa}</span>
      </div>
      <div class="alert-meta">
        è·¯ç·š: <span>${alert.line}</span><br>
        ã‚­ãƒ­ç¨‹: <span>${alert.km}</span><br>
        æœ€å¯„ã‚Šé§…ã¾ã§: <span>${alert.station}</span><br>
        æ¤œå‡ºæ™‚åˆ»: <span>${alert.time}</span>
      </div>
      ${assignHtml}
      <div class="alert-actions">
        <button class="alert-btn alert-btn-confirm" onclick="handleAlert(${alert.id},'confirm')">ç¢ºèª</button>
        <button class="alert-btn alert-btn-approve" onclick="handleAlert(${alert.id},'approve')">æ‰¿èª</button>
        <button class="alert-btn alert-btn-dismiss" onclick="handleAlert(${alert.id},'dismiss')">å´ä¸‹</button>
      </div>`;
    grid.appendChild(card);
  });
}

buildAlertGrid();

function handleAlert(id, action) {
  const card = document.getElementById(`alert-card-${id}`);
  if (!card || card.classList.contains('processed')) return;
  card.classList.add('processed');
  // Decrement count
  alertCount = Math.max(0, alertCount - 1);
  const alertObj = alertData.find(a => a.id === id);
  if (alertObj && alertObj.sev === 'critical') critCount = Math.max(0, critCount - 1);
  document.getElementById('navAlertCount').textContent = alertCount;
  document.getElementById('kpiAlertCount').textContent = alertCount + 'ä»¶';
  document.getElementById('alertCountBadge').innerHTML =
    `<span class="badge-dot"></span> ç·Šæ€¥ ${critCount}ä»¶`;
}

/* â”€â”€ Chart.js Charts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const chartDefaults = {
  plugins: { legend: { labels: { color:'#8888a0', font:{ size:11 }, boxWidth:12 } } },
  scales: {
    x: { ticks:{ color:'#8888a0', font:{size:11} }, grid:{ color:'rgba(30,30,46,0.8)' } },
    y: { ticks:{ color:'#8888a0', font:{size:11} }, grid:{ color:'rgba(30,30,46,0.8)' } },
  }
};

// Chart 1: Weekly trend
const weeksLabels = ['12/30','1/6','1/13','1/20','1/27','2/3','2/10','2/17'];
new Chart(document.getElementById('chartTrend'), {
  type: 'line',
  data: {
    labels: weeksLabels,
    datasets: [
      { label:'ç·Šæ€¥', data:[5,8,6,11,9,7,12,7], borderColor:'#ef4444', backgroundColor:'rgba(239,68,68,0.1)', tension:0.4, fill:true, pointRadius:3 },
      { label:'é‡è¦', data:[18,22,19,27,24,21,28,16], borderColor:'#f59e0b', backgroundColor:'rgba(245,158,11,0.1)', tension:0.4, fill:true, pointRadius:3 },
      { label:'è»½å¾®', data:[31,28,35,29,33,38,32,24], borderColor:'#22c55e', backgroundColor:'rgba(34,197,94,0.05)', tension:0.4, fill:false, pointRadius:3 },
    ]
  },
  options: {
    ...chartDefaults,
    responsive: true, maintainAspectRatio: false,
    plugins: {
      ...chartDefaults.plugins,
      tooltip: { mode:'index', intersect:false }
    }
  }
});

// Chart 2: Defect type doughnut
new Chart(document.getElementById('chartDoughnut'), {
  type: 'doughnut',
  data: {
    labels: ['ãƒ¬ãƒ¼ãƒ«ãè£‚','ãƒ¬ãƒ¼ãƒ«å‰¥é›¢','ãƒ¬ãƒ¼ãƒ«æ‘©è€—','ãƒ¬ãƒ¼ãƒ«æ³¢çŠ¶æ‘©è€—'],
    datasets: [{
      data: [23, 31, 28, 18],
      backgroundColor: ['rgba(239,68,68,0.8)','rgba(245,158,11,0.8)','rgba(99,102,241,0.8)','rgba(34,197,94,0.8)'],
      borderColor: ['#ef4444','#f59e0b','#6366f1','#22c55e'],
      borderWidth: 1,
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {
      legend: { position:'bottom', labels:{ color:'#8888a0', font:{size:11}, boxWidth:12, padding:12 } },
      tooltip: { callbacks: { label: ctx => ` ${ctx.label}: ${ctx.raw}ä»¶ (${Math.round(ctx.parsed/100*100)}%)` } }
    },
    cutout: '68%',
  }
});

// Chart 3: Line risk score bar
new Chart(document.getElementById('chartRisk'), {
  type: 'bar',
  data: {
    labels: ['ä¸­å¤®æœ¬ç·š','ç·æ­¦æœ¬ç·š','å¸¸ç£ç·š','æ±æµ·é“æœ¬ç·š','æ±åŒ—æœ¬ç·š','æ¨ªé ˆè³€ç·š','äº¬æµœæ±åŒ—ç·š','å±±æ‰‹ç·š'],
    datasets: [{
      label: 'ãƒªã‚¹ã‚¯ã‚¹ã‚³ã‚¢',
      data: [87, 74, 68, 61, 52, 38, 29, 18],
      backgroundColor: [
        'rgba(239,68,68,0.7)','rgba(239,68,68,0.6)','rgba(245,158,11,0.7)',
        'rgba(245,158,11,0.6)','rgba(99,102,241,0.6)','rgba(34,197,94,0.5)',
        'rgba(34,197,94,0.6)','rgba(34,197,94,0.7)',
      ],
      borderRadius: 4,
    }]
  },
  options: {
    indexAxis: 'y',
    responsive: true, maintainAspectRatio: false,
    plugins: { legend:{ display:false } },
    scales: {
      x: { ticks:{color:'#8888a0',font:{size:10}}, grid:{color:'rgba(30,30,46,0.8)'}, max:100 },
      y: { ticks:{color:'#e4e4ef',font:{size:11},fontWeight:'bold'}, grid:{display:false} }
    }
  }
});

/* â”€â”€ Maintenance Calendar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function buildCalendar() {
  const grid = document.getElementById('calGrid');
  const days = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'];
  days.forEach(d => {
    const cell = document.createElement('div');
    cell.className = 'cal-header-cell';
    cell.textContent = d;
    grid.appendChild(cell);
  });

  // Feb 2026: starts on Sunday (day 0)
  const year = 2026, month = 1; // 0-indexed
  const firstDay = new Date(year, month, 1).getDay(); // 0=Sun
  const daysInMonth = new Date(year, month+1, 0).getDate(); // 28
  const totalCells = 35;
  const today = 21;

  const events = {
    3:  [{ label:'é€šå¸¸ç‚¹æ¤œ', type:'routine' }],
    5:  [{ label:'ç·Šæ€¥å¯¾å¿œ ä¸­å¤®æœ¬ç·š', type:'emergency' }],
    7:  [{ label:'äºˆé˜²ä¿å…¨ æ±æµ·é“', type:'preventive' }],
    10: [{ label:'é€šå¸¸ç‚¹æ¤œ', type:'routine' }],
    12: [{ label:'äºˆé˜²ä¿å…¨ å¸¸ç£ç·š', type:'preventive' }],
    14: [{ label:'ç·Šæ€¥å¯¾å¿œ ç·æ­¦æœ¬ç·š', type:'emergency' }],
    17: [{ label:'é€šå¸¸ç‚¹æ¤œ', type:'routine' }],
    19: [{ label:'äºˆé˜²ä¿å…¨ æ±åŒ—æœ¬ç·š', type:'preventive' }],
    21: [{ label:'æœ¬æ—¥ é€šå¸¸ç‚¹æ¤œ', type:'routine' }, { label:'ç·Šæ€¥å¯¾å¿œ ä¸­å¤®æœ¬ç·š', type:'emergency' }],
    24: [{ label:'äºˆé˜²ä¿å…¨ å±±æ‰‹ç·š', type:'preventive' }],
    26: [{ label:'é€šå¸¸ç‚¹æ¤œ', type:'routine' }],
    28: [{ label:'äºˆé˜²ä¿å…¨ æ¨ªé ˆè³€ç·š', type:'preventive' }],
  };

  for (let i = 0; i < totalCells; i++) {
    const dayNum = i - firstDay + 1;
    const cell = document.createElement('div');
    cell.className = 'cal-cell';
    if (dayNum < 1 || dayNum > daysInMonth) {
      cell.classList.add('outside');
      cell.innerHTML = `<div class="cal-day">${dayNum < 1 ? '' : dayNum - daysInMonth}</div>`;
    } else {
      if (dayNum === today) cell.classList.add('today');
      cell.innerHTML = `<div class="cal-day">${dayNum}</div>`;
      if (events[dayNum]) {
        events[dayNum].forEach(ev => {
          const e = document.createElement('div');
          e.className = `cal-event ${ev.type}`;
          e.textContent = ev.label;
          cell.appendChild(e);
        });
      }
    }
    grid.appendChild(cell);
  }
})();

// Schedule list
const scheduleItems = [
  { type:'emergency', color:'sched-emergency', name:'ç·Šæ€¥å¯¾å¿œ â€” ä¸­å¤®æœ¬ç·š K+204.7', detail:'2026-02-21 æœ¬æ—¥ / æ‹…å½“: ç”°ä¸­ å¤ªéƒ' },
  { type:'routine',   color:'sched-routine',   name:'é€šå¸¸ç‚¹æ¤œ â€” æ±æµ·é“æœ¬ç·š å…¨ç·š',   detail:'2026-02-24 / æ‹…å½“: éˆ´æœ¨ ä¸€éƒ' },
  { type:'preventive',color:'sched-preventive',name:'äºˆé˜²ä¿å…¨ â€” å±±æ‰‹ç·š æ¸‹è°·â†’æ± è¢‹',  detail:'2026-02-24 / æ‹…å½“: ä½è—¤ å¥' },
  { type:'routine',   color:'sched-routine',   name:'é€šå¸¸ç‚¹æ¤œ â€” å¸¸ç£ç·š å…¨ç·š',       detail:'2026-02-26 / æ‹…å½“: ä¼Šè—¤ èª ' },
  { type:'preventive',color:'sched-preventive',name:'äºˆé˜²ä¿å…¨ â€” æ¨ªé ˆè³€ç·š å…¨ç·š',     detail:'2026-02-28 / æ‹…å½“: æ¸¡è¾º é›…å¿—' },
];

const schedList = document.getElementById('scheduleList');
scheduleItems.forEach(item => {
  const li = document.createElement('li');
  li.className = 'schedule-item';
  li.innerHTML = `
    <div class="schedule-type-dot ${item.color}"></div>
    <div class="schedule-info">
      <div class="schedule-name">${item.name}</div>
      <div class="schedule-detail">${item.detail}</div>
    </div>`;
  schedList.appendChild(li);
});

/* â”€â”€ Live Counter: inspection count increments every 12s â”€â”€â”€ */
let inspCount = 47;
setInterval(() => {
  inspCount++;
  document.getElementById('kpiInspCount').textContent = inspCount + 'ä»¶';
}, 12000);

/* â”€â”€ Frame counter ticks up â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let frames = 287432;
setInterval(() => {
  frames += rnd(120, 320);
  document.getElementById('frameCounter').textContent = frames.toLocaleString('ja-JP');
}, 3000);

/* â”€â”€ Clock update â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function updateClock() {
  const now = new Date();
  const hh = String(now.getHours()).padStart(2,'0');
  const mm = String(now.getMinutes()).padStart(2,'0');
  const ss = String(now.getSeconds()).padStart(2,'0');
  const el = document.getElementById('lastUpdate');
  if (el) el.textContent = `æœ€çµ‚æ›´æ–°: ${hh}:${mm}:${ss}`;
}
updateClock();
setInterval(updateClock, 1000);

/* â”€â”€ Chart.js global defaults â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
if (typeof Chart !== 'undefined') {
  Chart.defaults.color = '#8888a0';
  Chart.defaults.borderColor = 'rgba(30,30,46,0.8)';
  Chart.defaults.font.family = "-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif";
}
</script>
</body>
</html>
